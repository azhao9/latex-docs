% Problem 2
A=[1 0 0 0 -5 -1 -7 -3 0 -1 -2 -3 0;
0 1 0 0 -6 -2 5 -7 -9 3 -1 -9 -4;
0 0 1 0 -5 6 -5 -4 -1 -9 -8 1 -2;
0 0 0 1 -1 -7 -3 1 1 -4 0 -8 -7]

A =

     1     0     0     0    -5    -1    -7    -3     0    -1    -2    -3     0
     0     1     0     0    -6    -2     5    -7    -9     3    -1    -9    -4
     0     0     1     0    -5     6    -5    -4    -1    -9    -8     1    -2
     0     0     0     1    -1    -7    -3     1     1    -4     0    -8    -7

% pick row 4, column 6
A(:, [4, 6]) = A(:, [6, 4]);
A=rref(A);
A(:, [4, 6]) = A(:, [6, 4])

A =

    1.0000         0         0   -0.1429   -4.8571         0   -6.5714   -3.1429   -0.1429   -0.4286   -2.0000   -1.8571    1.0000
         0    1.0000         0   -0.2857   -5.7143         0    5.8571   -7.2857   -9.2857    4.1429   -1.0000   -6.7143   -2.0000
         0         0    1.0000    0.8571   -5.8571         0   -7.5714   -3.1429   -0.1429  -12.4286   -8.0000   -5.8571   -8.0000
         0         0         0   -0.1429    0.1429    1.0000    0.4286   -0.1429   -0.1429    0.5714         0    1.1429    1.0000

% pick row 3, column 10
A(:, [3, 10]) = A(:, [10, 3]);
A(:, [4, 6]) = A(:, [6, 4]);
A=rref(A);
A(:, [3, 10]) = A(:, [10, 3]);
A(:, [4, 6]) = A(:, [6, 4])

A =

    1.0000         0   -0.0345   -0.1724   -4.6552         0   -6.3103   -3.0345   -0.1379         0   -1.7241   -1.6552    1.2759
         0    1.0000    0.3333         0   -7.6667         0    3.3333   -8.3333   -9.3333         0   -3.6667   -8.6667   -4.6667
         0         0   -0.0805   -0.0690    0.4713         0    0.6092    0.2529    0.0115    1.0000    0.6437    0.4713    0.6437
         0         0    0.0460   -0.1034   -0.1264    1.0000    0.0805   -0.2874   -0.1494         0   -0.3678    0.8736    0.6322

% pick row 2, column 9
A(:, [2, 9]) = A(:, [9, 2]);
A(:, [3, 10]) = A(:, [10, 3]);
A(:, [4, 6]) = A(:, [6, 4]);
A=rref(A);
A(:, [2, 9]) = A(:, [9, 2]);
A(:, [3, 10]) = A(:, [10, 3]);
A(:, [4, 6]) = A(:, [6, 4])

A =

    1.0000   -0.0148   -0.0394   -0.1724   -4.5419         0   -6.3596   -2.9113         0         0   -1.6700   -1.5271    1.3448
         0   -0.1071   -0.0357         0    0.8214         0   -0.3571    0.8929    1.0000         0    0.3929    0.9286    0.5000
         0    0.0012   -0.0800   -0.0690    0.4618         0    0.6133    0.2426         0    1.0000    0.6392    0.4606    0.6379
         0   -0.0160    0.0407   -0.1034   -0.0037    1.0000    0.0271   -0.1539         0         0   -0.3091    1.0123    0.7069

% optimal solution in (LP) is [0, 0, 0, 0, 0.7069, 0, 0, 0.5, 0.6379, 0, 0]
% basis is columns 6, 9, 10
B = [2 9 -3; -6 1 9; 7 -1 4];
% y = c_B^T B^-1, c_B^T = [1 0 1]
y = [1 0 1] * inv(B)

y =

   0.0148   0.0394   0.1724

% optimal solution in (DP)
diary off
